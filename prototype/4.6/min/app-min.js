angular.module("particleApp",["lucidComponents"]).controller("mainCtrl",function(e,t){e.canvasmode=0,e.canvasMode=function(){return 0===e.canvasmode?(e.hideLeftPanel=!0,e.hideRightPanel=!0,e.hideFooter=!0,e.canvasmode=1,void console.log("Mode 1")):1===e.canvasmode?(e.hideToolbar=!0,e.hideHeader=!0,e.canvasmode=2,void console.log("Mode 2")):2===e.canvasmode?(e.hideLeftPanel=!1,e.hideRightPanel=!1,e.hideFooter=!1,e.hideToolbar=!1,e.hideHeader=!1,e.canvasmode=0,void console.log("Standard Canvas")):void 0},e.enterOptionBar=function(){e.hideHeader?timer=t(function(){e.hideHeader=!1,e.hideToolbar=!1,console.log("enter optionbar")},250):(e.hideHeader=!0,e.hideToolbar=!0)},e.enterRightPanel=function(){e.hideRightPanel?timer=t(function(){e.hideRightPanel=!1,console.log("enter right panel")},250):e.hideRightPanel=!0},e.enterLeftPanel=function(){e.hideLeftPanel?timer=t(function(){e.hideLeftPanel=!1,console.log("enter left panel")},250):e.hideLeftPanel=!0},e.cancelHover=function(){t.cancel(timer)}}).controller("ShareCtrl",function(e){e.showPopup=function(){e.showing=!0,e.dummyData={name:"",role:"Editor"}},e.addPerson=function(t){e.collaborators.push(t),e.showing=!1,e.dummyData={}},e.collaborators=[{name:"Ryan Contreras",role:"Owner",image:"https://s3.amazonaws.com/uifaces/faces/twitter/zack415/128.jpg"},{name:"Dave Smith",role:"Commenter",image:"https://s3.amazonaws.com/uifaces/faces/twitter/marcosmoralez/128.jpg"}]}).controller("RightDockCtrl",function(e,t){e.openTab="",e.showTooltipPresent=!0,e.showTooltipHistory=!0,e.setTab=function(n){n===e.openTab?e.openTab="":e.openTab=n,"comments"===e.openTab?(t.showComments=!0,t.showSlides=!1):"present"===e.openTab?(t.showSlides=!0,t.showComments=!1):(t.showComments=!1,t.showSlides=!1),""===e.openTab?e.rightDock=!1:e.rightDock=!0}}).controller("PagesCtrl",function(e,t,n,o){n.pages=o,n.currentPage=o[0],e.changePage=function(e){var o={name:e.name,blocks:[]};n.currentPage=o,t(function(){n.currentPage=e},10)},e.addPage=function(){var e=n.pages.length,o=(new Date).getTime(),a={name:"New Page "+(+e+1),id:o,blocks:[""]};n.pages.splice(e,0,a),t(function(){n.currentPage=a},10)},e.duplicatePage=function(e,o){var a=JSON.parse(JSON.stringify(e)),i=+o+1,l=(new Date).getTime();a.id=l,a.name=e.name+" Copy",n.pages.splice(i,0,a),t(function(){n.currentPage=a},10)},n.masterPageCount=function(){var e=[];return angular.forEach(n.pages,function(t){t.master&&e.push(t)}),e},e.deletePage=function(o,a){n.pages.splice(a,1),t(function(){n.pages[a]?e.changePage(n.pages[a]):e.changePage(n.pages[a-1])},10)},e.applyMaster=function(e){e.masterapplied=!0,console.log("page",e),t(function(){e.masterapplied=!1},2e3)},e.applyMasterAll=function(){console.log("master applied to all"),angular.forEach(n.pages,function(t){t.master||e.applyMaster(t)})}}).controller("SinglePageCtrl",function(e){e.renameData={},e.renamePage=function(t){e.page.name=t}}).controller("linePathCtrl",function(e,t){t(function(){e.lucidPath=new SVGMorpheus("#lucid-path-style")},1400),e.changePath=function(t){"straight"===t&&e.lucidPath.to("lucid-straight-path",{duration:400,easing:"quad-out",rotation:"none"}),"curved"===t&&e.lucidPath.to("lucid-curve-path",{duration:400,easing:"quad-out",rotation:"none"}),"angle"===t&&e.lucidPath.to("lucid-angle-path",{duration:400,easing:"quad-out",rotation:"none"}),e.showpopover=!1},e.pathstyles=[{name:"curved",icon:"https://s3-us-west-2.amazonaws.com/s.cdpn.io/t-157/icon-line-curved-bluesteel.svg"},{name:"angle",icon:"https://s3-us-west-2.amazonaws.com/s.cdpn.io/t-157/icon-line-angle-bluesteel.svg"},{name:"straight",icon:"https://s3-us-west-2.amazonaws.com/s.cdpn.io/t-157/icon-line-straight-bluesteel.svg"}],e.pathstyle=e.pathstyles[0]}).controller("textAlignmentCtrl",function(e,t){t(function(){e.lucidPath=new SVGMorpheus("#lucid-text-align")},1400),e.selected||(e.selected={},e.selected.text={verticalalignment:"middle",horizontalalignment:"center"}),e.changeAlignment=function(t,n){e.selected.text.verticalalignment=t,e.selected.text.horizontalalignment=n,"top"===t&&"left"===n&&e.lucidPath.to("lucid-text-top-left",{duration:400,easing:"quad-out",rotation:"none"}),"top"===t&&"center"===n&&e.lucidPath.to("lucid-text-top-center",{duration:400,easing:"quad-out",rotation:"none"}),"top"===t&&"right"===n&&e.lucidPath.to("lucid-text-top-right",{duration:400,easing:"quad-out",rotation:"none"}),"middle"===t&&"left"===n&&e.lucidPath.to("lucid-text-middle-left",{duration:400,easing:"quad-out",rotation:"none"}),"middle"===t&&"center"===n&&e.lucidPath.to("lucid-text-middle-center",{duration:400,easing:"quad-out",rotation:"none"}),"middle"===t&&"right"===n&&e.lucidPath.to("lucid-text-middle-right",{duration:400,easing:"quad-out",rotation:"none"}),"bottom"===t&&"left"===n&&e.lucidPath.to("lucid-text-bottom-left",{duration:400,easing:"quad-out",rotation:"none"}),"bottom"===t&&"center"===n&&e.lucidPath.to("lucid-text-bottom-center",{duration:400,easing:"quad-out",rotation:"none"}),"bottom"===t&&"right"===n&&e.lucidPath.to("lucid-text-bottom-right",{duration:400,easing:"quad-out",rotation:"none"}),e.showpopup=!1},e.alignment=[{verticalalignment:"top",horizontalalignment:"left",name:"top-left",icon:"https://s3-us-west-2.amazonaws.com/s.cdpn.io/t-157/icon-alignment_top-left-bluesteel.svg"},{verticalalignment:"top",horizontalalignment:"center",name:"top-center",icon:"https://s3-us-west-2.amazonaws.com/s.cdpn.io/t-157/icon-alignment_top-center-bluesteel.svg"},{verticalalignment:"top",horizontalalignment:"right",name:"top-right",icon:"https://s3-us-west-2.amazonaws.com/s.cdpn.io/t-157/icon-alignment_top-right-bluesteel.svg"},{verticalalignment:"middle",horizontalalignment:"left",name:"center-left",icon:"https://s3-us-west-2.amazonaws.com/s.cdpn.io/t-157/icon-alignment_center-left-bluesteel.svg"},{verticalalignment:"middle",horizontalalignment:"center",name:"center-center",icon:"https://s3-us-west-2.amazonaws.com/s.cdpn.io/t-157/icon-alignment_center-center-bluesteel.svg"},{verticalalignment:"middle",horizontalalignment:"right",name:"center-right",icon:"https://s3-us-west-2.amazonaws.com/s.cdpn.io/t-157/icon-alignment_center-right-bluesteel.svg"},{verticalalignment:"bottom",horizontalalignment:"left",name:"bottom-left",icon:"https://s3-us-west-2.amazonaws.com/s.cdpn.io/t-157/icon-alignment_bottom-left-bluesteel.svg"},{verticalalignment:"bottom",horizontalalignment:"center",name:"bottom-center",icon:"https://s3-us-west-2.amazonaws.com/s.cdpn.io/t-157/icon-alignment_bottom-center-bluesteel.svg"},{verticalalignment:"bottom",horizontalalignment:"right",name:"bottom-right",icon:"https://s3-us-west-2.amazonaws.com/s.cdpn.io/t-157/icon-alignment_bottom-right-bluesteel.svg"}]}).controller("shapesManagerCtrl",function(e,t,n,o,a){e.$on("draggable:start",function(e,n){t.draggingshape=!0}),e.$on("draggable:end",function(e,n){t.draggingshape=!1}),e.shapegroups=a.all(),t.manageshapes=!1,e.clickShapes=function(){e.searchshapes?e.searchshapes=!1:t.manageshapes=!t.manageshapes},e.copy=function(e){return"custom"===e?"copyMove":"copy"},e.dropFromCanvas=function(e,t,n){if(e&&n.custom){var o=n.shapes.indexOf(e);if(-1===o){var a=JSON.parse(JSON.stringify(e));a.shapepanel=!0,a.customcolor=!0,a.url||(a.svg='<svg width="30px" height="30px" viewBox="0 0 30 30" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g transform="translate(1, 2)" stroke="'+e.swatch.border+'" fill="'+e.swatch.fill+'"><rect stroke-width="2" x="0" y="0" width="28" height="26" rx="2"></rect><text font-family="Baskerville" font-size="18" font-weight="526" fill="'+e.swatch.text+'"><tspan x="7" y="19" stroke-width="0">T</tspan></text></g></svg>'),n.shapes.push(a)}console.log("dropped in saved shapes",e,t,n)}},e.dragoverCallback=function(e,t,n,o){return 10>t},e.dropCallback=function(e,t,n,o,a,i){if(o){if("itemType"===i&&!n.label)return!1;if("containerType"===i&&!angular.isArray(n))return!1}return n},e.newCustomGroup=function(){var e={groupname:"New Group",custom:"custom",edit:!0,shapes:[]};a.addGroup(e)},e.editName=function(e,t){e.edit=!0;var n="name-input-"+t;o(function(){document.getElementById(n).select()},10),e.edit=!0},e.pinnedCount=5,e.pinGroup=function(t){var n=a.get(t.id);n.pinned=!0,e.pinnedCount+=1,t.pinnedOrder=e.pinnedCount,e.showPinMessage(t),console.log("pin")},e.unPinGroup=function(e){a.get(e.id).pinned=!1,console.log("unpin")},e.togglePin=function(t){var n=a.get(t.id);t.pinned?e.unPinGroup(t):e.pinGroup(t)},e.showPinMessage=function(t){var n=document.getElementById("left-panel-shapes").offsetHeight<document.getElementById("left-panel-shapes-scroll").offsetHeight;n&&(e.overflowMessage=!0,e.overflowMessageTitle=t.groupname,o(function(){e.overflowMessage=!1},2e3))},e.openWindow=function(e){window.open(e,"_blank","toolbar=yes, scrollbars=yes, resizable=yes, top=500, left=500, width=400, height=400")}}).controller("canvasCtrl",function(e,t){e.lucidSlides=[{x:368,y:100,height:120,width:160},{x:60,y:210,height:300,width:400},{x:480,y:300,height:300,width:400}],e.blocks=t.currentPage.blocks,e.dragoverCallback=function(t,n,o,a){return e.logListEvent("dragged over canvas",t,n,o,a),10>n},e.dropCallback=function(t,n,o,a,i,l){if(e.logListEvent("dropped at canvas",t,n,a,i),a){if("itemType"===l&&!o.label)return!1;if("containerType"===l&&!angular.isArray(o))return!1}return o},e.dropToCanvas=function(e,n){var o=t.currentPage.blocks.indexOf(e);if(-1===o&&e){e.metrics||(e={customcolor:!1,swatch:{fill:"#ffffff",text:"#333333",border:"#666666"},swatchnumber:1,borderwidth:3,borderstyle:"solid",text:{verticalalignment:"middle",horizontalalignment:"center",text:e.name,size:"12px"},padding:10,metrics:{z:2,width:120,height:45},shapepanel:!1});var a=angular.element(document.querySelector("#lucid-canvas"))[0].getBoundingClientRect().left,i=angular.element(document.querySelector("#lucid-canvas"))[0].getBoundingClientRect().top;e.metrics.x=n.pageX-a-e.metrics.width/2,e.metrics.y=n.pageY-i-e.metrics.height/2,console.log("shape",e,n.pageX,n.pageY,"total: ",n),t.currentPage.blocks.push(e),t.selectedBlock=e}},e.onDragSuccess=function(e,t){if(t.x>250){var n=angular.element(document.querySelector("#lucid-canvas"))[0].getBoundingClientRect().left,o=angular.element(document.querySelector("#lucid-canvas"))[0].getBoundingClientRect().top;e&&(e.metrics.x=t.x-n-t.element.centerX,e.metrics.y=t.y-o-t.element.centerY,e.shapepanel=!1)}}});